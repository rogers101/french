<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="icon" type="image/png" href="france16.png" sizes="16x16" />
   <link rel="icon" type="image/png" href="france32.png" sizes="32x32" />
   <link rel="icon" type="image/png" href="france96.png" sizes="96x96" />
    <title>Learn French</title>
    <style>
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        .question {
            visibility: hidden;
        }
        .answer-seb, .answer-frances {
            visibility: hidden;
        }
        .speak-button, .toggle-visability {
            box-sizing:border-box;
            width: 49%;
            height: 30px;
            background: white;
            border: 1px #001e96 solid;
        }
        .toggle-visability {
            background-color: #001e96;
            color:white;
        }

        .done {
            box-sizing:border-box;
            width: 99%;
            height: 30px;
            background: #ee2436;
            border: none;
            margin: 70px 0;
            color:white;
        }
    </style>


</head>
<body>
    <div class="container">
    </div>
    <script>

        function displayPhrases() {
            for(phrase of phrases()) {
                let container = document.getElementsByClassName("container")[0]
                container.innerHTML = container.innerHTML + template()
                    .replace("[[english_question]]", phrase.english_question)
                    .replace("[[question]]", phrase.question)
                    .replace("[[answer_seb]]", phrase.answer_seb)
                    .replace("[[answer_frances]]", phrase.answer_frances)
            }
        }
        
        function attachEvents() {
            for(let speakButton of document.getElementsByClassName("speak-button")) {
                speakButton.addEventListener("click", speakAnswer);
            }

            for(let visibilityButton of document.getElementsByClassName("toggle-visability")) {
                visibilityButton.addEventListener("click", toggleVisability);
            }

            for(let doneButton of document.getElementsByClassName("done")) {
                doneButton.addEventListener("click", hidePhrase);
            }
        }

        function hidePhrase(event) {
            const parent = event.target.parentElement
            parent.style.display = "none"
        }

        function toggleVisability(event) {
            const element = event.target.getAttribute("data-element");
            const parent = event.target.parentElement
            let text = parent.getElementsByClassName(element)[0]

            text.style.visibility = text.style.visibility == "visible" ? "hidden" : "visible";
        }

        function speakAnswer(event) {
            speak(getText(event))
        }

        function getText(event) {
            const element = event.target.getAttribute("data-text");
            const parent = event.target.parentElement

            return parent.getElementsByClassName(element)[0].innerHTML

        }
        // https://stackoverflow.com/questions/51904607/ios-safari-speechsynthesisutterance-can-not-set-language
        function speak(text) {
            let utterance = new SpeechSynthesisUtterance(text)
            utterance.lang = 'fr-FR'
            utterance.voice = window.speechSynthesis.getVoices().find((voice) => voice.lang === 'fr-FR')
            speechSynthesis.speak(utterance)
        }

        function phrases() {
            return [
                {
                    "english_question":"What is your name?",
                    "question": "Comment tu t’appelles?",
                    "answer_seb": "Je m’appelle Sébastian",
                    "answer_frances": "Je m’appelle Frances",
                },
                {
                    "english_question":"When do you live?",
                    "question": "Où habites-tu?",
                    "answer_seb": "J’habite à Bristol, en Angleterre.",
                    "answer_frances": "Je viens de Belfast, en Irlande du Nord.",
                },
                {
                    "english_question":"What is your profession?",
                    "question": "Quel est ton métier?",
                    "answer_seb": "Je suis ingénier informatique.",
                    "answer_frances": "je travaille dans un hôpital",
                },
                {
                    "english_question":"How old are you?",
                    "question": "Quel âge as-tu?",
                    "answer_seb": "J'ai trente-deux ans",
                    "answer_frances": "J'ai trente et un ans",
                },
                {
                    "english_question":"Where are you from?",
                    "question": "D’où es-tu?",
                    "answer_seb": "Je suis de Dorset, en Angleterre",
                    "answer_frances": "Je viens de Belfast, en Irlande du Nord.",
                }
            ]
        }

        function template() {
            return  `<div class="phrase">
                <h1 class="english_question">[[english_question]]</h1>
                
                <p class="question">[[question]]</p>
                <button class="speak-button" data-text="question">Speak Question</button>
                <button class="toggle-visability" data-element="question">Show Question</button>

                <p class="answer-seb">[[answer_seb]]</p>
                <button class="speak-button" data-text="answer-seb">Speak Seb Answer</button>
                <button class="toggle-visability" data-element="answer-seb">Show Seb Answer</button>
                
                <p class="answer-frances">[[answer_frances]]</p>
                <button class="speak-button" data-text="answer-frances">Speak Frances Answer</button>
                <button class="toggle-visability" data-element="answer-frances">Show Frances Answer</button>
                
                <button class="done" >Done</button>
            </div>`
        }
        
        displayPhrases()
        attachEvents()
    </script>
</body>
